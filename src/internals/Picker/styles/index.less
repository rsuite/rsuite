@import '../../../styles/common.less';
@import '../../../Button/styles/index.less';
@import '../../../styles/mixins/listbox.less';
@import '../../../styles/mixins/combobox.less';
@import '../../../Stack/styles/index.less';
@import '../../../Loader/styles/index.less';
@import '../../../Input/styles/index.less';
@import '../../../InputGroup/styles/index.less';
@import '../../../Highlight/styles/index.less';
@import '../../CloseButton/styles/index.less';
@import './mixin.less';

//
// Pickers
// --------------------------------------------------

// Common styles
// ----------------------
.rs-picker {
  --rs-picker-value-count-border-radius: var(--rs-radius-full);
  --rs-picker-value-count-padding: calc(var(--rs-spacing) * 1.5);
  --rs-picker-value-count-margin: var(--rs-spacing);
  --rs-picker-size: 0.875rem;
  --rs-picker-loader-size: 20px;
  --rs-picker-toggle-border-width: 1px;
  --rs-picker-toggle-bg: var(--rs-input-bg);

  &-toggle-wrapper {
    display: inline-block;
    // Clear whitespace.
    vertical-align: middle;
    max-width: 100%;
  }

  &-block {
    display: block;
    width: 100%;
  }

  &-disabled {
    cursor: not-allowed;

    .rs-picker-toggle-value,
    .rs-picker-toggle-indicator,
    .rs-picker-tag-list .rs-tag {
      color: var(--rs-text-disabled) !important;
    }

    .rs-picker-value-count {
      opacity: 0.5;
    }
  }

  &-toggle &-toggle-placeholder {
    color: var(--rs-text-secondary);
  }

  &-has-value .rs-btn &-toggle-value,
  &-has-value &-toggle &-toggle-value {
    color: var(--rs-picker-value);
  }

  &-countable &-toggle-value {
    display: flex;
    align-items: center;
  }

  &-value-list {
    flex: 0 1 auto;
    .ellipsis-basic();
  }

  &-value-count {
    margin-inline: var(--rs-picker-value-count-margin);
    background-color: var(--rs-picker-count-bg);
    color: var(--rs-picker-count-text);
  }

  &-value-separator {
    margin: 0 var(--rs-spacing) 0 0;
  }

  &:not(.rs-picker-disabled):hover,
  &.rs-picker-focused {
    border-color: var(--rs-input-focus-border);
  }

  &-toggle-active,
  &.rs-picker-focused {
    box-shadow: var(--rs-state-focus-shadow);
  }

  &-label.rs-input-group-addon {
    color: var(--rs-text-primary);
    padding-right: 4px !important;
  }

  &-loader {
    width: var(--rs-picker-loader-size);
    height: var(--rs-picker-loader-size);
    display: flex;
    align-items: center;
  }

  &-error > .rs-picker-input-group {
    border-color: var(--rs-picker-state-error);

    &:hover {
      border-color: var(--rs-picker-state-error);
    }

    &:focus-within {
      border-color: var(--rs-picker-state-error);
      outline: var(--rs-picker-state-error-outline);
    }
  }
}

// Picker Menu
.rs-picker-popup {
  --rs-picker-popup-none-padding: calc(var(--rs-spacing) * 3);
  --rs-picker-popup-border-radius: var(--rs-radius-md);
  --rs-picker-search-box-padding: calc(var(--rs-spacing) * 1.5) calc(var(--rs-spacing) * 3);
  --rs-picker-popup-z-index: @zindex-picker-popup;

  position: absolute;
  text-align: left;
  overflow: hidden;
  transition: none;
  display: flex;
  flex-direction: column;
  z-index: var(--rs-picker-popup-z-index);
  border-radius: var(--rs-picker-popup-border-radius);
  background-color: var(--rs-bg-overlay);
  box-shadow: var(--rs-shadow-overlay);
  padding-block: var(--rs-picker-popup-border-radius);

  .high-contrast-mode({
    border: 1px solid var(--rs-border-primary);
  });

  // Increase z-index when modal opened.
  .rs-modal-open & {
    --rs-picker-popup-z-index: calc(@zindex-modal + @zindex-picker-toggle);
  }

  // Increase z-index when drawer opened.
  .rs-drawer-open & {
    --rs-picker-popup-z-index: calc(@zindex-drawer + @zindex-picker-toggle);
  }

  &.rs-picker-inline {
    position: relative;
    box-shadow: none;
  }

  .rs-search-box {
    padding: var(--rs-picker-search-box-padding);
  }

  .rs-highlight .rs-highlight-mark {
    padding: 0;
  }

  // Empty listbox
  .rs-picker-none {
    padding: var(--rs-picker-popup-none-padding);
    color: var(--rs-text-secondary);
    cursor: default;
  }
}

.rs-picker-toggle {
  .picker-default-toggle();
  .picker-subtle-toggle();

  &-label {
    color: var(--rs-text-primary);
  }

  .rs-picker-toggle-stack {
    flex: 1 1 auto;
    gap: calc(var(--rs-spacing) * 2);
    overflow: hidden;
  }

  &-value {
    display: block;
    .ellipsis();
  }

  &-textbox {
    position: absolute;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    border: 1px solid #0000;
    padding-inline-start: 10px;
    padding-inline-end: 32px;
    color: var(--rs-text-primary);
    background-color: var(--rs-input-bg);
    outline: none;
  }

  &.rs-btn-lg &-textbox {
    padding-inline-start: 14px;
  }

  &.rs-btn-sm &-textbox {
    padding-inline-start: 8px;
  }

  &.rs-btn-xs &-textbox {
    padding-inline-start: 6px;
  }

  &-read-only {
    opacity: 0;
  }

  .rs-picker-default & {
    transition: @picker-transition;

    .high-contrast-mode({
      transition: none;
    });
  }

  .rs-picker-default:not(.rs-picker-disabled) & {
    &:hover,
    &:focus,
    &-active {
      border-color: var(--rs-input-focus-border);
    }
  }

  .rs-picker-subtle & {
    .rs-btn-subtle();

    transition: none;

    &-active {
      background-color: var(--rs-btn-subtle-hover-bg);
      color: var(--rs-btn-subtle-hover-text);
    }
  }
}

.rs-picker-toggle.rs-btn {
  text-align: left;
  display: inline-flex;
  width: 100%;
  align-items: center;
  justify-content: flex-start;
  padding-inline: calc(var(--rs-btn-padding-inline) - var(--rs-picker-toggle-border-width));
}

.rs-picker-toggle-indicator {
  display: inline-flex;
  align-items: center;

  // Picker clear button
  .rs-picker-clean {
    .combobox-indicator-icon();

    background: inherit;
    color: var(--rs-text-secondary);
    transition: 0.2s color linear;
    cursor: pointer;

    &.rs-btn-close {
      padding: 0;
    }
  }

  // Picker toggle caret
  .rs-picker-caret-icon {
    // Extend  Dropdown toggle caret style
    .combobox-indicator-icon();

    font-size: var(--rs-font-size-md);
    color: var(--rs-text-secondary);
  }
}

// Make sure styles the same with <Input>
.rs-picker-default,
.rs-picker-input {
  .rs-btn,
  .rs-picker-toggle {
    background-color: var(--rs-picker-toggle-bg);
  }

  &.rs-picker-disabled {
    --rs-picker-toggle-bg: var(--rs-input-disabled-bg);
  }

  &.rs-picker-disabled .rs-input-group {
    pointer-events: none;
  }
}

// Check Item
.rs-check-item {
  display: block;

  &:not(.rs-checkbox-disabled):hover,
  &:focus,
  &&-focus {
    .listbox-option-active();

    .high-contrast-mode({
      .rs-check-tree-node-text-wrapper {
        text-decoration: underline;
      }
    });
  }

  .rs-checkbox-checker {
    display: flex;

    > label {
      cursor: pointer;
      width: 100%;
      padding-inline: var(--rs-check-item-padding-inline);
      padding-block: var(--rs-check-item-padding-block);

      .high-contrast-mode({
        transition: none;
      });

      &::before {
        background-color: var(--rs-bg-overlay);

        .high-contrast-mode({
          background: none;
        });
      }

      .rs-checkbox-disabled& {
        cursor: not-allowed;
      }

      .grouped &,
      .@{ckpns}-menu-group-children & {
        padding-left: @picker-check-item-content-padding-left +
          @picker-children-check-item-padding-left;
      }
    }

    .rs-checkbox-control {
      .grouped &,
      .@{ckpns}-menu-group-children & {
        left: (@picker-item-content-padding-horizontal + @picker-children-check-item-padding-left);
      }
    }
  }
}

.rs-picker-menu-group {
  background-color: var(--rs-listbox-option-group-bg);
  position: sticky;
  top: -1px;
  z-index: 1;
}

.rs-virt-list {
  // Use for single selection
  .rs-picker-select-menu-item,

  // Use for multiple selection with Checkbox
  .rs-check-item label {
    .ellipsis-basic();
  }
}

.rs-tree-virt-list {
  // Use for single selection
  .rs-tree-node-label {
    .ellipsis-basic();
  }
}
